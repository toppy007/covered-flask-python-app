<h3 align="left">Job Ad Analysis</h3>
<br />

<div class="container">
    <div class="row">
        <div class="col-md-4">
            <div class="card" style="width: 18rem;">
                <div class="card-body">
                    <canvas id="myChart1" width="200" height="200"></canvas>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card" style="width: 18rem;">
                <div class="card-body">
                    <canvas id="myChart2" width="200" height="200"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js"></script>

<script>
    fetch('/get-doughnut-core-skills-data')
    .then(response => response.json())
    .then(data => {
        percentage = data['percentage'];

        const chartData = {
            datasets: [{
                data: [data['Matched'], data['No Match']],
                backgroundColor: [
                'rgba(255, 26, 104, 0.2)',
                'rgba(54, 162, 235, 0.2)'
                ],
                borderColor: [
                'rgba(255, 26, 104, 1)',
                'rgba(54, 162, 235, 1)'
                ],
                borderWidth: 1
            }]
        };

        const doughnutLabal = {
            id: 'doughnutLabal',
            beforeDatasetDraw(chart, arg, pluginOptions) {
                const { ctx, data } = chart;

                ctx.save();
                const xCoor = chart.getDatasetMeta(0).data[0].x;
                const yCoor = chart.getDatasetMeta(0).data[0].y;
                ctx.font = 'bold 75px sans-serif';
                ctx.fillstyle = 'roba(54, 162, 235, 1)';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(`${percentage}%`, xCoor, yCoor);
            }

        }

        const config = {
            type: 'doughnut',
            data: chartData,
            options: {},
            plugins: [doughnutLabal]
        };
    
        const myChart1 = new Chart(
        document.getElementById('myChart1'),
        config
        );
    });

</script>

<script>
    fetch('/get-bar-project-score-data')
    .then(response => {
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      return response.json();
    })
    .then(data => {
      // Data is now an array of objects received from the Flask route
      const chartData = {
        labels: data.map(item => item[1]), // Use the second element of each tuple as labels
        datasets: [{
          data: data.map(item => item[2]), // Use the third element of each tuple as data
          backgroundColor: 'rgba(255, 26, 104, 0.2)',
          borderColor: 'rgba(255, 26, 104, 1)',
          borderWidth: 1
        }]
      };
  
      const config = {
        type: 'bar',
        data: chartData,
        options: {
          indexAxis: 'y',
          elements: {
            bar: {
              borderWidth: 2,
            }
          },
          responsive: true,
          plugins: {
            legend: {
              display: false,
            },
        },
      };
  
      const myChart2 = new Chart(
        document.getElementById('myChart2'),
        config
      );
    })
    .catch(error => {
      console.error('Error:', error);
      // Handle the error gracefully, e.g., display an error message to the user
    });
  
  
</script>

