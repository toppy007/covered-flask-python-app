{% extends "base.html" %}

{% block title %}Generate{% endblock %}

{% block content %}
<br />
<h3 align="center">Create Job Advertisement</h3>
<br />

<form method="POST">
  <div class="form-group">
    <label for="job_ad">Job Advertisement</label>
    <textarea
      class="form-control"
      id="job_ad"
      name="job_ad"
      rows="8"
      placeholder="Enter job advertisement content"
    ></textarea>
  </div>

  <h5 align="left">Add core skill to the personal statement</h5>

  <form method="POST">
    <div class="form-group">
        <label for="selectTag">Select a Skill:</label>
        <select id="selectTag" class="form-control">
            {% for skill in user.skills %}
            <option value="{{ skill.data }}">{{ skill.data }}</option>
            {% endfor %}
        </select>
    </div>
    <div>
        <button type="button" class="btn btn-primary" onclick="addSelectedSkill()">Add Skill Tag</button>
    </div>
</form>

<div class="mt-3">
    <h4>Selected Skill Tags:</h4>
    <div id="selectedTags">
        <!-- Selected skill tags will be displayed here -->
    </div>
</div>

<script>
    function addSelectedSkill() {
        const selectTag = document.getElementById("selectTag");
        const selectedSkill = selectTag.value;

        const skillInput = document.getElementById("skill");
        $(skillInput).tagsinput('add', selectedSkill);

        // Remove the selected skill from the dropdown options
        selectTag.querySelector(`option[value="${selectedSkill}"]`).remove();

        // Display the selected skill tag in the separate area
        const selectedTagsDiv = document.getElementById("selectedTags");
        
        const tagContainer = document.createElement("div");
        tagContainer.className = "badge badge-secondary mr-1";
        
        const tagText = document.createElement("span");
        tagText.textContent = selectedSkill;
        tagContainer.appendChild(tagText);

        const deleteButton = document.createElement("span");
        deleteButton.innerHTML = "&times;";
        deleteButton.className = "ml-2";
        deleteButton.style.cursor = "pointer";
        deleteButton.onclick = function() {
            selectedTagsDiv.removeChild(tagContainer);
            // Optionally, add the skill back to the dropdown options
            selectTag.innerHTML += `<option value="${selectedSkill}">${selectedSkill}</option>`;
            $(skillInput).tagsinput('remove', selectedSkill);
        };
        
        tagContainer.appendChild(deleteButton);
        selectedTagsDiv.appendChild(tagContainer);
    }
</script>

{% endblock %}