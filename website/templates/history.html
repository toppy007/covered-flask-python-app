{% extends "base.html" %}

{% block content %}

<br />
<h1 align="left">Job Application History</h1>
<br />
    <div class="container mt-5">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Company Name</th>
                    <th>Position</th>
                    <th>Recruiter's Name</th>
                    <th>Covering Letter</th>
                    <th>Job Ad</th>
                    <th>Timestamp</th>
                </tr>
            </thead>
            <tbody>
                {% for history_entry in job_history_data %}
                    <tr>
                        <td>{{ history_entry.company_name }}</td>
                        <td>{{ history_entry.position }}</td>
                        <td>{{ history_entry.recruiters_name }}</td>
                        <td>
                            <button class="btn btn-primary popup-button" data-toggle="modal" data-target="#myModal-{{ history_entry.id }}">View CL</button>
                            <div class="modal fade" id="myModal-{{ history_entry.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="myModalLabel">Covering Letter</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            {{ history_entry.covering_letter }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <button class="btn btn-primary popup-button" data-toggle="modal" data-target="#myModal-{{ history_entry.id }}">View Job</button>
                        </td>
                        <td>{{ history_entry.timestamp }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/popper.js@2.11.6/dist/umd/popper.min.js" integrity="sha384-ToszPY8B9zpBb0KKhP2j3h/XyKtu8uyDVIaIwfl1q5G5Fsd5SY6f8p00JECfUKF5" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js" integrity="sha384-6tz7No9l1T+hZx5z2w6f+JXjSMfD5Dk/fC4xBb4E/TFtF0cSrNVjQFAF8k5sdt7ZP" crossorigin="anonymous"></script>


  <script>
    document.addEventListener("DOMContentLoaded", function() {
        const popupButtons = document.querySelectorAll(".popup-button");
        const overlay = document.getElementById("overlay");
        const popup = document.getElementById("popup");
        const popupContent = document.getElementById("popup-content");
        const closePopupButton = document.getElementById("close-popup");
    
        popupButtons.forEach(function(button) {
            button.addEventListener("click", function() {
                const text = button.getAttribute("data-text");
    
                // Set the popup content
                popupContent.textContent = text;
    
                // Show the overlay and popup
                overlay.style.display = "block";
                popup.style.display = "block";
            });
        });
    
        closePopupButton.addEventListener("click", function() {
            // Close the popup and overlay
            overlay.style.display = "none";
            popup.style.display = "none";
        });
    });


    </script>


{% endblock %}

