{% extends "base.html" %} 
{% block title %}Profile{% endblock %} 
{% block content%}
  <br />
    <h1 align="left">Profile</h1>
  <br />
    <h3 align="left">OpenAI Access Parameters</h3>
  <br />

{% if not user.api_keys %}
  <form method="POST">
    <h5 align="left">Upload Api Key</h5>
      <div class="form-group">
        <input type="text" class="form-control" id="api_key" name="api_key" placeholder="Enter API Key"/>
      </div>
    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
{% else %}
  <h5 align="left">API Key</h5>
  <ul class="list-group list-group-flush" id="notes">
    {% for api_key in user.api_keys %}
    <li class="list-group-item">Your OpenAI API Key 
      <button type="button" class="close" onClick="deleteApiKey({{ api_key.id }})">
        <span aria-hidden="true">&times;</span>
      </button>
    </li>
    {% endfor %}
  </ul>
{% endif %} 
  <br />
    <h3 align="left">Personalize Settings and Info</h3>
  <br />
    <h5 align="left">Build a database of notes your want to mention in your covering letter</h5>
      <ul class="list-group list-group-flush" id="notes">
      {% for note in user.notes %}
        <li class="list-group-item">
          {{ note.data }}
          <button type="button" class="close" onClick="deleteNote({{ note.id }})">
            <span aria-hidden="true">&times;</span>
          </button>
        </li>
      {% endfor %}
      </ul>
    <form method="POST">
      <div class="form-group">
        <textarea name="note" id="note" class="form-control"></textarea>
      </div>
      <button type="submit" class="btn btn-primary">Add Statement Note</button>
    </form>

    <br />
    <h5 align="left">Add core skills to a cover letter skills database</h5>
    <div class="form-group">
      <ul class="list-group list-skill-flush d-inline-block" id="skills">
        {% for skill in user.skills %}
        <li class="btn btn-outline-primary d-inline-block mr-1 btn-sm mb-2">
          {{ skill.data }}
          <button type="button" class="close ml-2" aria-label="close" onClick="deleteSkill({{ skill.id }})">
            <span aria-hidden="true">&times;</span>
          </button>
        </li>
        {% endfor %}
      </ul>
    </div>
    <form action="{{ url_for('views.profile') }}" method="POST" id="skill-form">
      <div class="form-group">
        <input type="text" name="skill" id="skill" class="form-control" placeholder="Enter your core skill here">
      </div>
      <button type="submit" class="btn btn-primary mb-1">Add Core Skill</button>
    </form>
  
  <br />
  <h5 align="left">Build your projects database to include into your covering letter</h5>
  <br />
  
  <h3>Projects</h3>
  <table class="table">
    <thead>
      <tr>
        <th>Project Title</th>
        <th>Project Date</th>
        <th>Project Link</th>
        <th>Project Description</th>
        <th>Core Skills</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for project in user.projects %}
      <tr>
        <td>{{ project.project_title }}</td>
        <td>{{ project.project_date }}</td>
        <td>{{ project.project_link }}</td>
        <td>{{ project.project_description }}</td>
        <td>{{ project.project_core_skill }}</td>
        <td>
          <button type="button" class="btn btn-danger" onClick="deleteProject({{ project.id }})">
            Delete
          </button>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>  

  <button id="toggleFormBtn" class="btn btn-primary mb-3">Add Project</button>

  <div class="container mt-1">
    <form method="POST" id="projectForm" {% if not show_form %}style="display: none"{% endif %}>
      <div class="form-group">
        <label for="project_title">Project Title:</label>
        <input type="text" name="project_title" id="project_title" class="form-control" placeholder="Enter Project Title">
      </div>
      <div class="form-group">
        <label for="project_client">Project Client:</label>
        <input type="text" name="project_client" id="project_client" class="form-control" placeholder="Enter Project Client">
      </div>

      <div class="form-group">
        <label for="project_date_range">Date Range:</label>
        <div class="input-group">
          <select name="project_date_from_month" class="custom-select">
            {% for month in range(1, 13) %}
              <option value="{{ '%02d'|format(month) }}">{{ month }}</option>
            {% endfor %}
          </select>
          <select name="project_date_from_year" class="custom-select ml-2">
            {% for year in range(2022, 2030) %}
              <option value="{{ year }}">{{ year }}</option>
            {% endfor %}
          </select>
          <span class="mx-2">to</span>
          <select name="project_date_to_month" class="custom-select">
            {% for month in range(1, 13) %}
              <option value="{{ '%02d'|format(month) }}">{{ month }}</option>
            {% endfor %}
          </select>
          <select name="project_date_to_year" class="custom-select ml-2">
            {% for year in range(2022, 2030) %}
              <option value="{{ year }}">{{ year }}</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <div class="form-group">
        <label for="project_link">Project Link:</label>
        <input type="text" name="project_link" id="project_link" class="form-control" placeholder="Enter Project Link">
      </div>
      <div class="form-group">
        <label for="project_description">Project Description:</label>
        <textarea name="project_description" id="project_description" class="form-control" placeholder="Enter Project Description"></textarea>
      </div>
      <div class="form-group">
        <label for="project_core_skill">Core Skills:</label>
        <input type="text" name="project_core_skill" id="project_core_skill" class="form-control" placeholder="Enter Core Skills">
      </div>
      <div class="text-left">
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="reset" class="btn btn-danger ml-2">Reset</button>
      </div>
    </form>
  </div>

    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const toggleFormBtn = document.getElementById('toggleFormBtn');
        const projectForm = document.getElementById('projectForm');
        const skillInput = document.getElementById('skill');
        const skillForm = document.getElementById('skill-form');
  
        toggleFormBtn.addEventListener('click', function() {
          if (projectForm.style.display === 'none') {
            projectForm.style.display = 'block';
            toggleFormBtn.textContent = 'Hide Form';
          } else {
            projectForm.style.display = 'none';
            toggleFormBtn.textContent = 'Add Project';
          }
        });
  
        skillInput.addEventListener('keydown', function(event) {
          if (event.key === 'Enter') {
            event.preventDefault(); // Prevent default Enter key behavior
            skillForm.submit(); // Submit the form
          }
        });
  
        // Add any other event listeners or scripts here
      });
    </script>

    
  {% endblock %}
